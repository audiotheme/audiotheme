jQuery(function(a){var b=a("#gig-date"),c=a("#gig-time"),d=a("#gig-venue"),e=a("#gig-venue-timezone-group"),f=a("#gig-venue-timezone"),g=a("#gig-venue-timezone-search"),h=sessionStorage||{},i="lastGigDate"in h?new Date(h.lastGigDate):null,j="lastGigTime"in h?new Date(h.lastGigTime):null;e.pointer({audiothemeId:"at100_gigvenue_tz"}),i&&i.setDate(i.getDate()+1),b.datepicker({dateFormat:"yy/mm/dd",defaultDate:i,showOn:"both",buttonImage:audiothemeGigsL10n.datepickerIcon}).next("button").wrap('<span class="audiotheme-input-append-trigger">'),c.timepicker({scrollDefaultTime:j||"",timeFormat:audiothemeGigsL10n.timeFormat,className:"ui-autocomplete"}).on("showTimepicker",function(){a(this).addClass("open"),a(".ui-timepicker-list").width(a(this).outerWidth())}).on("hideTimepicker",function(){a(this).removeClass("open")}).next().on("click",function(){c.focus()}),a("#publish").on("click",function(){var a=b.datepicker("getDate"),d=c.timepicker("getTime");h&&""!==a&&(h.lastGigDate=a),h&&""!==d&&(h.lastGigTime=d)}),d.autocomplete({change:function(){""!==d.val()?a.ajax({url:ajaxurl,data:{action:"audiotheme_ajax_is_new_venue",name:d.val()},dataType:"json",success:function(a){a.length?e.hide().pointer("close"):e.show().pointer("audiothemeOpen")}}):e.hide().pointer("close")},select:function(){e.hide().pointer("close")},source:ajaxurl+"?action=audiotheme_ajax_get_venue_matches",minLength:0,position:"undefined"!=typeof isRtl&&isRtl?{my:"right top",at:"right bottom",offset:"0, -1"}:{offset:"0, -1"},open:function(){a(this).addClass("open")},close:function(){a(this).removeClass("open")}}),a("#gig-venue-select").on("click",function(){d.focus().autocomplete("search","")}),g.autocomplete({source:function(b,c){a.ajax({url:"http://api.wordpress.org/core/name-to-zoneinfo/1.0/",type:"GET",data:{s:g.val()},dataType:"jsonp",jsonpCallback:"dummyCallback",success:function(b){c(a.map(b,function(a){return{label:a.name+", "+a.location+" - "+a.timezone,value:a.timezone,location:a.location,timezone:a.timezone}}))}})},minLength:2,select:function(a,b){f.find('option[value="'+b.item.timezone+'"]').attr("selected","selected")},position:"undefined"!=typeof isRtl&&isRtl?{my:"right top",at:"right bottom",offset:"0, -1"}:{offset:"0, -1"},open:function(){a(this).addClass("open")},close:function(){a(this).removeClass("open")}})});